import{d as L,r as h,a as b,o as T,b as U,c as W,e as p,t as _,f as r,w as a,u as n,g as I,h as S,i as $,j as z,k as R,l as q,m as N,n as g,p as c}from"./index.101a8097.js";import{E as A,a as M}from"./el-form-item.96e03ac6.js";import{E as P,a as j,b as x}from"./el-notification.8865d44b.js";import{_ as J}from"./TranslateBtn.cd15b2ad.js";import{f as K}from"./el-loading.ac4b049a.js";import{l as E}from"./loading.5592677f.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import"./refs.43ece32d.js";function G(w){return K({url:"/login",method:"post",data:w})}const H={class:"login-page"},Q={class:"login-rule-form"},X={class:"title"},Y={class:"title-text"},Z={class:"translate-btn"},ee=L({setup(w){const{proxy:{$lodash:D}}=I(),y=S(),B=$(),s=h({userName:"admin",passWord:"123456"}),f=b(),k=h({userName:[{validator:(t,o,e)=>{if(o.trim()==="")return e(new Error("\u8BF7\u8F93\u5165\u7528\u6237\u540D!"));o.length<3?e(new Error("\u7528\u6237\u540D\u5E94\u4E0D\u5C0F\u4E8E3\u4F4D!")):e()},trigger:"blur"}],passWord:[{validator:(t,o,e)=>{o.trim()===""?e(new Error("\u8BF7\u8F93\u5165\u5BC6\u7801!")):o.length<6?e(new Error("\u5BC6\u7801\u8BE56\u4F4D\u4EE5\u4E0A!")):e()},trigger:"blur"}]}),C=()=>{s.userName==="admin"?s.userName="xiaoming":s.userName="admin"},v=t=>{!t||t.validate(async o=>{if(o){E.openLoading();try{const e=await G(s);if((e==null?void 0:e.status)===200){const{token:l,userName:u,userRoles:d}=e.data,i=new Date(Date.now()+g().expiredTime);c.set("loginTime",Date.now()),c.set("token",l,{expires:i}),c.set("userName",u,{expires:i}),c.set("userRoles",JSON.stringify(d),{expires:i}),y.query.redirect?B.replace({path:String(y.query.redirect)}):B.replace({name:"home"}),x({duration:g().tipDurationS,message:"\u767B\u5F55\u6210\u529F!",type:"success"})}E.closeLoading()}catch(e){console.log("\u767B\u5F55\u63A5\u53E3\u9519\u8BEF:",e)}finally{E.closeLoading()}}else return x({duration:g().tipDurationM,title:"Warning",message:"\u8BF7\u68C0\u67E5\u586B\u5199\u5185\u5BB9!",type:"warning"}),!1})},V=t=>{t.key.toLowerCase()==="enter"&&v(f.value)},F=D.debounce(V,300);return T(()=>{setTimeout(()=>{window.addEventListener("keydown",F)},300)}),U(()=>{window.removeEventListener("keydown",F)}),(t,o)=>{const e=J,l=P,u=A,d=j,i=M;return z(),W("div",H,[p("div",Q,[p("h1",X,[p("div",Y,_(t.$t("login.title")),1),p("div",Z,[r(e)])]),r(i,{ref_key:"ruleFormEl",ref:f,model:n(s),rules:n(k),class:"ruleForm"},{default:a(()=>[r(u,{class:"username",prop:"userName"},{default:a(()=>[r(l,{clearable:"",size:"large","prefix-icon":n(R),placeholder:"\u7528\u6237\u540D",modelValue:n(s).userName,"onUpdate:modelValue":o[0]||(o[0]=m=>n(s).userName=m),type:"text",autocomplete:"off"},null,8,["prefix-icon","modelValue"])]),_:1}),r(u,{class:"password",prop:"passWord"},{default:a(()=>[r(l,{"show-password":"",size:"large","prefix-icon":n(q),placeholder:"\u5BC6\u7801",modelValue:n(s).passWord,"onUpdate:modelValue":o[1]||(o[1]=m=>n(s).passWord=m),type:"password",autocomplete:"off"},null,8,["prefix-icon","modelValue"])]),_:1}),r(u,{class:"btns"},{default:a(()=>[r(d,{size:"large",type:"primary",onClick:o[2]||(o[2]=m=>v(f.value))},{default:a(()=>[N(_(t.$t("login.loginBtn")),1)]),_:1}),r(d,{size:"large",onClick:C},{default:a(()=>[N(_(t.$t("login.switchBtn")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}});var me=O(ee,[["__scopeId","data-v-fc4e7de6"]]);export{me as default};
