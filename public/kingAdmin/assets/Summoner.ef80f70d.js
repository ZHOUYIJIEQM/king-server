import{d as W,a as i,r as Q,G as X,o as Y,a0 as E,w as o,u as _,ad as Z,n as r,bJ as ee,j as D,at as B,f as l,e as w,t as g,bK as ae,m as k,a1 as te,bk as le,bL as oe,c as ne,a_ as se,V as ue,W as ie,g as re}from"./index.53c63d4b.js";import{v as de}from"./el-loading.78ffb8dc.js";import{E as me,a as ce,_ as pe}from"./el-table-column.714a4e0c.js";import{E as _e,a as ge}from"./el-form-item.70998100.js";import{a as be,E as ve,b}from"./el-notification.21f2a4e2.js";import{E as fe,a as ye}from"./el-select.ac111c1c.js";import{_ as De}from"./UploadFile.9ada552d.js";import"./el-tooltip.586473e3.js";import{E as Ee}from"./el-image-viewer.2755d104.js";import{E as we}from"./el-message-box.29aa3b87.js";import"./el-overlay.eb570a85.js";import{c as Se,u as Fe,s as he,g as Ce,d as $e}from"./summoner.10c50b0a.js";import{_ as Be}from"./plugin-vue_export-helper.21dcd24c.js";import"./validator.865f57ff.js";import"./refs.38a50a92.js";/* empty css                */import"./browser.c4480726.js";const ke={style:{"font-weight":"bold"}},Te={class:"option"},Ve=W({setup(Ue){const{proxy:S}=re(),{$lodash:T}=S,d=i(!1),m=i(!1),F=i([]),c=i(!1),v=Q({pageNum:1,pageSize:10}),h=i(0);let u={pageNum:1,pageSize:10,sortItem:"rank",orderType:"ascending"};const n=i({}),f=i(""),V=X(()=>`${r().uploadPath}/inscription`),U=e=>{f.value=e,n.value.icon=e},A=async e=>{u=Object.assign({},u,e),await p(u)},N=async e=>{m.value=!0,d.value=!0,f.value="",n.value={desc:[""]}},x=async()=>{try{c.value=!0;let e={};m.value?e=await Se(n.value):e=await Fe(n.value._id,n.value),e.status===200&&b({duration:r().tipDurationS,type:"success",message:e.data.message}),d.value=!1,await p(u)}catch(e){console.log(e),b({duration:r().tipDurationS,type:"success",message:e.message})}finally{c.value=!1}},I=async e=>{u.orderType=e.order,await p(u)},H=async e=>{d.value=!0,m.value=!1,f.value=e.img,n.value=T.cloneDeep(e),await ie(),setTimeout(()=>{S.$refs.nameEl.focus()},50)},z=async e=>{we.confirm("\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u94ED\u6587\u5417?","\u5220\u9664\u94ED\u6587",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async a=>{const s=await $e(e._id);s.status===200?(b({duration:r().tipDurationS,type:"success",message:`${e.name} ${s.data.message}`}),await p(u)):b({duration:r().tipDurationS,type:"error",message:s.data.message})}).catch(a=>{console.log(a)})},p=async e=>{try{c.value=!0;let a={};e!=null&&e.name?a=await he(e):a=await Ce(e),F.value=a==null?void 0:a.data.data,h.value=a==null?void 0:a.data.total}catch(a){b({duration:r().tipDurationS,type:"error",message:a.message})}finally{setTimeout(()=>{c.value=!1},300)}};return Y(async()=>{await p(u)}),(e,a)=>{const s=me,j=Ee,C=be,L=ce,$=ve,y=_e,O=De,M=fe,P=ye,R=ge,q=pe,G=ee("permission"),J=de;return D(),E(q,{showSearch:"",pagination:_(v),"onUpdate:pagination":a[3]||(a[3]=t=>Z(v)?v.value=t:v=t),visible:d.value,"onUpdate:visible":a[4]||(a[4]=t=>d.value=t),isAdd:m.value,totalNum:h.value,btnAdd:e.$t("btn.addSummoner"),dialogTitle:m.value?e.$t("btn.addSummoner"):e.$t("btn.editSummoner"),onReloadData:A,onAddDataItem:N,onSaveContent:x},{table:o(()=>[B((D(),E(L,{border:"","empty-text":"\u6682\u65E0\u53EC\u5524\u5E08\u6280\u80FD!",data:F.value,"default-sort":{prop:"rank",order:"ascending"},onSortChange:I},{default:o(()=>[l(s,{align:"center",type:"index",label:e.$t("tableH.orderNum"),width:"70"},null,8,["label"]),l(s,{align:"center",width:"80px",label:e.$t("tableH.name"),prop:"name"},null,8,["label"]),l(s,{width:"90px",sortable:"custom",label:e.$t("tableH.grade"),align:"center",prop:"rank"},null,8,["label"]),l(s,{"class-name":"img-box",width:"100px",label:e.$t("tableH.image"),align:"center",prop:"img"},{default:o(t=>[l(j,{lazy:"",class:"item-icon",src:t.row.img},null,8,["src"])]),_:1},8,["label"]),l(s,{"min-width":"250px",label:e.$t("tableH.desc"),prop:"description"},{default:o(t=>[w("span",ke,g(t.row.description.split("CD\uFF1A").at(0))+"CD\uFF1A",1),w("span",null,g(t.row.description.split("CD\uFF1A").slice(1).join("")),1)]),_:1},8,["label"]),l(s,{label:e.$t("tableH.operation"),align:"center",width:"150"},{default:o(t=>[w("div",Te,[l(C,{size:"small",type:"primary",plain:"",icon:_(ae),onClick:K=>H(t.row)},{default:o(()=>[k(g(e.$t("btn.edit"))+" / "+g(e.$t("btn.view")),1)]),_:2},1032,["icon","onClick"]),B((D(),E(C,{style:te({"margin-top":_(le)().valueHasPermission(["admin"])?"10px":""}),size:"small",type:"danger",plain:"",icon:_(oe),onClick:K=>z(t.row)},{default:o(()=>[k(g(e.$t("btn.delete")),1)]),_:2},1032,["style","icon","onClick"])),[[G,["admin"]]])])]),_:1},8,["label"])]),_:1},8,["data"])),[[J,c.value]])]),dialog:o(()=>[l(R,{class:"dialog-from",model:n.value,"label-width":"70px","label-position":"left"},{default:o(()=>[l(y,{label:"\u6280\u80FD\u540D\u79F0"},{default:o(()=>[l($,{clearable:"",ref:"nameEl",modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.name=t),placeholder:"\u8BF7\u8F93\u5165\u6280\u80FD\u540D\u79F0!"},null,8,["modelValue"])]),_:1}),l(y,{label:"\u6280\u80FD\u56FE\u6807"},{default:o(()=>[l(O,{class:"icon-upload",actionUrl:_(V),imageUrl:f.value,onUploadSuccess:U},null,8,["actionUrl","imageUrl"])]),_:1}),l(y,{label:"\u89E3\u9501\u7B49\u7EA7"},{default:o(()=>[l(P,{modelValue:n.value.rank,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.rank=t),placeholder:"Select"},{default:o(()=>[(D(),ne(ue,null,se(30,t=>l(M,{key:t,label:t,value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"\u6280\u80FD\u8BF4\u660E"},{default:o(()=>[l($,{clearable:"",type:"textarea",modelValue:n.value.description,"onUpdate:modelValue":a[2]||(a[2]=t=>n.value.description=t),placeholder:"\u8BF7\u8F93\u5165\u6280\u80FD\u63CF\u8FF0!"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["pagination","visible","isAdd","totalNum","btnAdd","dialogTitle"])}}});var Qe=Be(Ve,[["__scopeId","data-v-368f3d40"]]);export{Qe as default};
