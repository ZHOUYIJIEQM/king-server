import{d as D,a as s,G as b,c as d,e as f,f as _,w as m,m as v,j as c,V as C,a_ as B,u as F,a0 as T}from"./index.3ca1645a.js";import{E as U,a as w}from"./el-table-column.bd304a43.js";import"./el-tag.c1c1dc80.js";import"./el-tooltip.586473e3.js";import{E as V}from"./el-scrollbar.5cf2b49c.js";import{i as j}from"./excel.f80f3bce.js";import{_ as A}from"./plugin-vue_export-helper.21dcd24c.js";import"./debounce.eb328bbe.js";import"./_arrayPush.ab7ef295.js";const N={class:"main-page"},L=v(" \u628AExcel\u6587\u4EF6\u62D6\u5230\u8FD9\u91CC\u6216 "),O=v(" \u9009\u62E9\u6253\u5F00 "),P=D({setup(R){const r=s(!1),l=s([]),n=s(),x=b(()=>{if(l.value.length){let e=0,a=0;return l.value.forEach((t,o)=>{Object.keys(t).length>a&&(e=o)}),Object.keys(l.value[e])}return[]}),g=e=>{n.value.click()},E=e=>{r.value=!0;const t=e.target.files[0];!t||u(t)},u=e=>{n.value.value=null;const a=new FileReader;a.readAsArrayBuffer(e),a.onload=t=>{try{const o=t.target.result;l.value=j(o),r.value=!1}catch(o){console.log(o)}}},h=e=>{if(r.value)return;const a=e.dataTransfer.files;u(a[0]),e.stopPropagation(),e.preventDefault()},p=e=>{e.dataTransfer.dropEffect="copy",e.stopPropagation(),e.preventDefault()};return(e,a)=>{const t=V,o=U,y=w;return c(),d("div",N,[f("input",{ref_key:"excelUploadEl",ref:n,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:E},null,544),f("div",{class:"drop",onDrop:h,onDragover:p,onDragenter:p},[L,_(t,{loading:r.value,type:"primary",onClick:g},{default:m(()=>[O]),_:1},8,["loading"])],32),_(y,{border:"",data:l.value,style:{"margin-top":"2em"}},{default:m(()=>[(c(!0),d(C,null,B(F(x),(i,k)=>(c(),T(o,{key:k,prop:i,label:i},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}}});var S=A(P,[["__scopeId","data-v-3d8101ea"]]);export{S as default};
