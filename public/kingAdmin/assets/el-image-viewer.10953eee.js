var Le=Object.defineProperty,Ee=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var me=(l,o,n)=>o in l?Le(l,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[o]=n,X=(l,o)=>{for(var n in o||(o={}))ze.call(o,n)&&me(l,n,o[n]);if(ve)for(var n of ve(o))Oe.call(o,n)&&me(l,n,o[n]);return l},Q=(l,o)=>Ee(l,Ce(o));import{q as xe,af as R,A as ge,B as re,am as we,aj as fe,d as ae,bq as pe,br as Se,bs as Te,I as ye,aH as Ne,a as h,bt as Ae,ap as $e,G as k,J as ie,W as be,o as he,j as I,a0 as ue,f,w as E,e as m,O as v,u as e,ay as Be,a3 as _,av as x,bu as Re,c as S,bv as Ve,bh as Me,V as ce,bw as De,bx as Ye,a2 as Fe,by as He,bz as Xe,a_ as Pe,at as je,au as We,a1 as de,N as ee,a4 as qe,aI as Ge,_ as ke,aB as V,ah as B,bA as Ze,a5 as Ie,an as Je,aw as Ke,aG as Ue,E as Qe,t as ea,bB as aa}from"./index.2cb99b72.js";import{i as ta}from"./browser.54340351.js";import{i as _e,k as na}from"./el-notification.58c91947.js";import{d as sa,g as la}from"./validator.b5f03a2e.js";var oa="Expected a function";function oe(l,o,n){var r=!0,p=!0;if(typeof l!="function")throw new TypeError(oa);return xe(n)&&(r="leading"in n?!!n.leading:r,p="trailing"in n?!!n.trailing:p),sa(l,o,{leading:r,maxWait:o,trailing:p})}const ra=(l,o)=>{if(!R||!l||!o)return!1;const n=l.getBoundingClientRect();let r;return o instanceof Element?r=o.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<r.bottom&&n.bottom>r.top&&n.right>r.left&&n.left<r.right},ia=ge({urlList:{type:re(Array),default:()=>we([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ua={close:()=>!0,switch:l=>fe(l)},ca=["src"],da=ae({name:"ElImageViewer"}),fa=ae(Q(X({},da),{props:ia,emits:ua,setup(l,{expose:o,emit:n}){const r=l,p={CONTAIN:{name:"contain",icon:pe(Se)},ORIGINAL:{name:"original",icon:pe(Te)}},C=ta()?"DOMMouseScroll":"mousewheel",{t:te}=_e(),u=ye("image-viewer"),{nextZIndex:M}=Ne(),g=h(),L=h([]),N=Ae(),w=h(!0),d=h(r.initialIndex),A=$e(p.CONTAIN),c=h({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=k(()=>{const{urlList:a}=r;return a.length<=1}),P=k(()=>d.value===0),j=k(()=>d.value===r.urlList.length-1),Y=k(()=>r.urlList[d.value]),ne=k(()=>{const{scale:a,deg:s,offsetX:i,offsetY:y,enableTransition:z}=c.value;let b=i/a,O=y/a;switch(s%360){case 90:case-270:[b,O]=[O,-b];break;case 180:case-180:[b,O]=[-b,-O];break;case 270:case-90:[b,O]=[-O,b];break}const $={transform:`scale(${a}) rotate(${s}deg) translate(${b}px, ${O}px)`,transition:z?"transform .3s":""};return A.value.name===p.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$}),W=k(()=>fe(r.zIndex)?r.zIndex:M());function T(){le(),n("close")}function se(){const a=oe(i=>{switch(i.code){case B.esc:r.closeOnPressEscape&&T();break;case B.space:J();break;case B.left:K();break;case B.up:t("zoomIn");break;case B.right:U();break;case B.down:t("zoomOut");break}}),s=oe(i=>{(i.wheelDelta?i.wheelDelta:-i.detail)>0?t("zoomIn",{zoomRate:1.2,enableTransition:!1}):t("zoomOut",{zoomRate:1.2,enableTransition:!1})});N.run(()=>{V(document,"keydown",a),V(document,C,s)})}function le(){N.stop()}function q(){w.value=!1}function G(a){w.value=!1,a.target.alt=te("el.image.error")}function Z(a){if(w.value||a.button!==0||!g.value)return;c.value.enableTransition=!1;const{offsetX:s,offsetY:i}=c.value,y=a.pageX,z=a.pageY,b=oe($=>{c.value=Q(X({},c.value),{offsetX:s+$.pageX-y,offsetY:i+$.pageY-z})}),O=V(document,"mousemove",b);V(document,"mouseup",()=>{O()}),a.preventDefault()}function F(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function J(){if(w.value)return;const a=Ze(p),s=Object.values(p),i=A.value.name,z=(s.findIndex(b=>b.name===i)+1)%a.length;A.value=p[a[z]],F()}function H(a){const s=r.urlList.length;d.value=(a+s)%s}function K(){P.value&&!r.infinite||H(d.value-1)}function U(){j.value&&!r.infinite||H(d.value+1)}function t(a,s={}){if(w.value)return;const{zoomRate:i,rotateDeg:y,enableTransition:z}=X({zoomRate:1.4,rotateDeg:90,enableTransition:!0},s);switch(a){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/i).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*i).toFixed(3)));break;case"clockwise":c.value.deg+=y;break;case"anticlockwise":c.value.deg-=y;break}c.value.enableTransition=z}return ie(Y,()=>{be(()=>{const a=L.value[0];a!=null&&a.complete||(w.value=!0)})}),ie(d,a=>{F(),n("switch",a)}),he(()=>{var a,s;se(),(s=(a=g.value)==null?void 0:a.focus)==null||s.call(a)}),o({setActiveItem:H}),(a,s)=>(I(),ue(Ge,{to:"body",disabled:!a.teleported},[f(qe,{name:"viewer-fade",appear:""},{default:E(()=>[m("div",{ref_key:"wrapper",ref:g,tabindex:-1,class:v(e(u).e("wrapper")),style:de({zIndex:e(W)})},[m("div",{class:v(e(u).e("mask")),onClick:s[0]||(s[0]=Be(i=>a.hideOnClickModal&&T(),["self"]))},null,2),_(" CLOSE "),m("span",{class:v([e(u).e("btn"),e(u).e("close")]),onClick:T},[f(e(x),null,{default:E(()=>[f(e(Re))]),_:1})],2),_(" ARROW "),e(D)?_("v-if",!0):(I(),S(ce,{key:0},[m("span",{class:v([e(u).e("btn"),e(u).e("prev"),e(u).is("disabled",!a.infinite&&e(P))]),onClick:K},[f(e(x),null,{default:E(()=>[f(e(Ve))]),_:1})],2),m("span",{class:v([e(u).e("btn"),e(u).e("next"),e(u).is("disabled",!a.infinite&&e(j))]),onClick:U},[f(e(x),null,{default:E(()=>[f(e(Me))]),_:1})],2)],64)),_(" ACTIONS "),m("div",{class:v([e(u).e("btn"),e(u).e("actions")])},[m("div",{class:v(e(u).e("actions__inner"))},[f(e(x),{onClick:s[1]||(s[1]=i=>t("zoomOut"))},{default:E(()=>[f(e(De))]),_:1}),f(e(x),{onClick:s[2]||(s[2]=i=>t("zoomIn"))},{default:E(()=>[f(e(Ye))]),_:1}),m("i",{class:v(e(u).e("actions__divider"))},null,2),f(e(x),{onClick:J},{default:E(()=>[(I(),ue(Fe(e(A).icon)))]),_:1}),m("i",{class:v(e(u).e("actions__divider"))},null,2),f(e(x),{onClick:s[3]||(s[3]=i=>t("anticlockwise"))},{default:E(()=>[f(e(He))]),_:1}),f(e(x),{onClick:s[4]||(s[4]=i=>t("clockwise"))},{default:E(()=>[f(e(Xe))]),_:1})],2)],2),_(" CANVAS "),m("div",{class:v(e(u).e("canvas"))},[(I(!0),S(ce,null,Pe(a.urlList,(i,y)=>je((I(),S("img",{ref_for:!0,ref:z=>L.value[y]=z,key:i,src:i,style:de(e(ne)),class:v(e(u).e("img")),onLoad:q,onError:G,onMousedown:Z},null,46,ca)),[[We,y===d.value]])),128))],2),ee(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var va=ke(fa,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ma=Ie(va),pa=ge({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:re([String,Object])},previewSrcList:{type:re(Array),default:()=>we([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),ga={load:l=>l instanceof Event,error:l=>l instanceof Event,switch:l=>fe(l),close:()=>!0,show:()=>!0},wa=["src","loading"],ya={key:0},ba=ae({name:"ElImage",inheritAttrs:!1}),ha=ae(Q(X({},ba),{props:pa,emits:ga,setup(l,{emit:o}){const n=l;let r="";const{t:p}=_e(),C=ye("image"),te=Je(),u=na(),M=h(),g=h(!1),L=h(!0),N=h(!1),w=h(),d=h(),A=R&&"loading"in HTMLImageElement.prototype;let c,D;const P=k(()=>te.style),j=k(()=>{const{fit:t}=n;return R&&t?{objectFit:t}:{}}),Y=k(()=>{const{previewSrcList:t}=n;return Array.isArray(t)&&t.length>0}),ne=k(()=>{const{previewSrcList:t,initialIndex:a}=n;let s=a;return a>t.length-1&&(s=0),s}),W=k(()=>n.loading==="eager"?!1:!A&&n.loading==="lazy"||n.lazy),T=()=>{!R||(L.value=!0,g.value=!1,M.value=n.src)};function se(t){L.value=!1,g.value=!1,o("load",t)}function le(t){L.value=!1,g.value=!0,o("error",t)}function q(){ra(w.value,d.value)&&(T(),F())}const G=aa(q,200);async function Z(){var t;if(!R)return;await be();const{scrollContainer:a}=n;Ue(a)?d.value=a:Qe(a)&&a!==""?d.value=(t=document.querySelector(a))!=null?t:void 0:w.value&&(d.value=la(w.value)),d.value&&(c=V(d,"scroll",G),setTimeout(()=>q(),100))}function F(){!R||!d.value||!G||(c==null||c(),d.value=void 0)}function J(t){if(!!t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function H(){!Y.value||(D=V("wheel",J,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",N.value=!0,o("show"))}function K(){D==null||D(),document.body.style.overflow=r,N.value=!1,o("close")}function U(t){o("switch",t)}return ie(()=>n.src,()=>{W.value?(L.value=!0,g.value=!1,F(),Z()):T()}),he(()=>{W.value?Z():T()}),(t,a)=>(I(),S("div",{ref_key:"container",ref:w,class:v([e(C).b(),t.$attrs.class]),style:de(e(P))},[M.value!==void 0&&!g.value?(I(),S("img",Ke({key:0},e(u),{src:M.value,loading:t.loading,style:e(j),class:[e(C).e("inner"),e(Y)&&e(C).e("preview"),L.value&&e(C).is("loading")],onClick:H,onLoad:se,onError:le}),null,16,wa)):_("v-if",!0),L.value||g.value?(I(),S("div",{key:1,class:v(e(C).e("wrapper"))},[L.value?ee(t.$slots,"placeholder",{key:0},()=>[m("div",{class:v(e(C).e("placeholder"))},null,2)]):g.value?ee(t.$slots,"error",{key:1},()=>[m("div",{class:v(e(C).e("error"))},ea(e(p)("el.image.error")),3)]):_("v-if",!0)],2)):_("v-if",!0),e(Y)?(I(),S(ce,{key:2},[N.value?(I(),ue(e(ma),{key:0,"z-index":t.zIndex,"initial-index":e(ne),infinite:t.infinite,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:K,onSwitch:U},{default:E(()=>[t.$slots.viewer?(I(),S("div",ya,[ee(t.$slots,"viewer")])):_("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):_("v-if",!0)],64)):_("v-if",!0)],6))}}));var ka=ke(ha,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const za=Ie(ka);export{za as E};
