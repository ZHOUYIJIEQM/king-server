(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f6fd9f2"],{3575:function(t,s,e){},4717:function(t,s,e){"use strict";e("fec5")},"751e":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"rcmd-mv"},[s("div",{ref:"imgbox",staticClass:"img-box"},[s("transition",{attrs:{name:"fadeIn"}},[t.imgShow?s("img",{ref:"img",on:{click:function(s){return t.clickVideo(t.rcmdMv.id)}}}):t._e()]),s("video",{ref:"rcmdVideo",on:{click:function(s){return t.clickVideo(t.rcmdMv.id)},play:t.vdoPlay,pause:t.vdoPause,error:t.vdoErr,playing:t.playing,waiting:t.waiting}}),t.updateTime?s("span",{staticClass:"duration"},[t._v(t._s(t.updateTime))]):s("span",{staticClass:"duration"},[t._v(t._s(t.duration))]),t.playStatus.length?s("div",{staticClass:"play-status"},[s("van-loading",{directives:[{name:"show",rawName:"v-show",value:"stop"===t.playStatus,expression:"playStatus==='stop'"}],attrs:{size:".14rem",color:"#fff"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:"play"===t.playStatus,expression:"playStatus==='play'"}],staticClass:"loader"},[s("div",{staticStyle:{"--x":"0"}}),s("div",{staticStyle:{"--x":"1"}}),s("div",{staticStyle:{"--x":"2"}})])],1):t._e()],1),s("div",{staticClass:"mv-info",on:{click:t.toMvPlayer}},[s("div",{staticClass:"name two-eli"},[t._v(t._s(t.rcmdMv.name))]),s("div",{staticClass:"playinfo"},[s("div",{staticClass:"count"},[s("i",{staticClass:"iconfont icon-bofangsanjiaoxing"}),s("span",[t._v(t._s(t._f("formatNum")(t.rcmdMv.playCount)))])]),t.rcmdMv.praisedCount?s("div",{staticClass:"praised-count"},[s("i",{staticClass:"iconfont icon-zan"}),s("span",[t._v(t._s(t._f("formatNum")(t.rcmdMv.praisedCount)))])]):t._e(),s("div",{staticClass:"tag text-eli"},[t._v(t._s(t.rcmdMv.tag))])])])])},a=[],r=e("4ec3"),o=e("c1df"),c=e.n(o),d=e("5a84"),n={mixins:[d["a"]],props:{rcmdMv:{type:Object,default:function(){return{}}}},data(){return{imgShow:!1,bgc:["#f58a8a","#f59f8a","#f5c78a","#9ee0b4","#a8f58a","#e5f58a","#9ecfe0","#9eabe0","#c59ee0","#f7c7b2"],vdoTimer:null,updateTime:0,playStatus:""}},computed:{duration(){return c()(this.rcmdMv.duration).format("mm:ss")}},mounted(){this.loadImg(),this.visible()},methods:{loadImg(){this.$refs.imgbox.style.background=this.bgc[this.roundNum(0,this.bgc.length-1)];let t=new Image;t.src=this.rcmdMv.img,t.onload=()=>{this.imgShow=!0,this.$nextTick(()=>{this.$refs.img.src=this.rcmdMv.img})}},roundNum(t,s){return Math.round(Math.random()*(s-t)+t)},async clickVideo(t){this.$store.commit("changeMvId",t),this.playStatus="stop";try{let s=this.$refs.rcmdVideo;if(s.src)this.toggleVdoStatus();else{if(this.rcmdMv.url)s.src=this.rcmdMv.url;else{let e=await Object(r["n"])(t);e=e.data.url,s.src=e}s.oncanplay=()=>{s.play(),this.$refs.img.style.zIndex="-1"}}}catch(s){console.log(s)}},toggleVdoStatus(){let t=this.$refs.rcmdVideo;t.paused?t.play():t.pause()},setPStatus(t){setTimeout(()=>{this.playStatus=t},100)},vdoTimeUpdate(){let t=this.$refs.rcmdVideo;this.updateTime=c()(1e3*parseInt(Math.ceil(t.currentTime))).format("mm:ss")},vdoPlay(){this.setPStatus("stop"),this.getVdoCTime(),this.vdoTimer=setInterval(()=>{this.getVdoCTime()},1e3)},getVdoCTime(){let t=this.$refs.rcmdVideo,s=t.currentTime;"number"!==typeof s&&(s=0),this.updateTime=c()(1e3*parseInt(t.duration-Math.ceil(s))).format("mm:ss")},vdoPause(){clearInterval(this.vdoTimer),this.setPStatus("")},vdoErr(){this.$toast("网络原因, 视频播放错误!")},visible(){let t=0;try{let s=document.querySelector("html");t=window.getComputedStyle(s).fontSize,t=.5*parseInt(/(\d+)/g.exec(t)[0]),t=t>0?"-"+t+"px":"-30px"}catch(e){t="-30px"}let s=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting||this.$refs.rcmdVideo.paused||this.$refs.rcmdVideo.pause()})},{rootMargin:`${t} 0px ${t} 0px`});s.observe(this.$refs.rcmdVideo)},playing(){this.setPStatus("play")},waiting(){this.setPStatus("stop")},toMvPlayer(){this.loginStatus?this.clickMvIcon(this.rcmdMv.id,"video"):this.clickMvIcon(this.rcmdMv.id,"mv")}},watch:{"$store.getters.mvId":{handler:function(t){t!==this.rcmdMv.id&&(this.updateTime=c()(this.rcmdMv.duration).format("mm:ss"),this.$refs.rcmdVideo.pause(),this.$refs.rcmdVideo.removeAttribute("src"),this.$refs.rcmdVideo.load(),clearInterval(this.vdoTimer),this.setPStatus(""),this.$refs.img&&(this.$refs.img.style.zIndex=""))}}}},l=n,m=(e("84a5"),e("4717"),e("2877")),u=Object(m["a"])(l,i,a,!1,null,"7d4b8aa8",null);s["default"]=u.exports},"84a5":function(t,s,e){"use strict";e("3575")},fec5:function(t,s,e){}}]);
//# sourceMappingURL=chunk-2f6fd9f2.9fb1d969.js.map